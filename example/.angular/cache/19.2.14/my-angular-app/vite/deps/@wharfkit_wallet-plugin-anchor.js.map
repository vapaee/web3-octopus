{
  "version": 3,
  "sources": ["../../../../../../node_modules/eventemitter3/index.js", "../../../../../../node_modules/@greymass/buoy/lib/buoy-client.m.js", "../../../../../../node_modules/@greymass/miniaes/lib/miniaes.m.js", "../../../../../../node_modules/@wharfkit/protocol-esr/lib/protocol-esr.m.js", "../../../../../../node_modules/@wharfkit/wallet-plugin-anchor/lib/wallet-plugin-anchor.m.js"],
  "sourcesContent": ["'use strict';\n\nvar has = Object.prototype.hasOwnProperty,\n  prefix = '~';\n\n/**\n * Constructor to create a storage for our `EE` objects.\n * An `Events` instance is a plain object whose properties are event names.\n *\n * @constructor\n * @private\n */\nfunction Events() {}\n\n//\n// We try to not inherit from `Object.prototype`. In some engines creating an\n// instance in this way is faster than calling `Object.create(null)` directly.\n// If `Object.create(null)` is not supported we prefix the event names with a\n// character to make sure that the built-in object properties are not\n// overridden or used as an attack vector.\n//\nif (Object.create) {\n  Events.prototype = Object.create(null);\n\n  //\n  // This hack is needed because the `__proto__` property is still inherited in\n  // some old browsers like Android 4, iPhone 5.1, Opera 11 and Safari 5.\n  //\n  if (!new Events().__proto__) prefix = false;\n}\n\n/**\n * Representation of a single event listener.\n *\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} [once=false] Specify if the listener is a one-time listener.\n * @constructor\n * @private\n */\nfunction EE(fn, context, once) {\n  this.fn = fn;\n  this.context = context;\n  this.once = once || false;\n}\n\n/**\n * Add a listener for a given event.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} context The context to invoke the listener with.\n * @param {Boolean} once Specify if the listener is a one-time listener.\n * @returns {EventEmitter}\n * @private\n */\nfunction addListener(emitter, event, fn, context, once) {\n  if (typeof fn !== 'function') {\n    throw new TypeError('The listener must be a function');\n  }\n  var listener = new EE(fn, context || emitter, once),\n    evt = prefix ? prefix + event : event;\n  if (!emitter._events[evt]) emitter._events[evt] = listener, emitter._eventsCount++;else if (!emitter._events[evt].fn) emitter._events[evt].push(listener);else emitter._events[evt] = [emitter._events[evt], listener];\n  return emitter;\n}\n\n/**\n * Clear event by name.\n *\n * @param {EventEmitter} emitter Reference to the `EventEmitter` instance.\n * @param {(String|Symbol)} evt The Event name.\n * @private\n */\nfunction clearEvent(emitter, evt) {\n  if (--emitter._eventsCount === 0) emitter._events = new Events();else delete emitter._events[evt];\n}\n\n/**\n * Minimal `EventEmitter` interface that is molded against the Node.js\n * `EventEmitter` interface.\n *\n * @constructor\n * @public\n */\nfunction EventEmitter() {\n  this._events = new Events();\n  this._eventsCount = 0;\n}\n\n/**\n * Return an array listing the events for which the emitter has registered\n * listeners.\n *\n * @returns {Array}\n * @public\n */\nEventEmitter.prototype.eventNames = function eventNames() {\n  var names = [],\n    events,\n    name;\n  if (this._eventsCount === 0) return names;\n  for (name in events = this._events) {\n    if (has.call(events, name)) names.push(prefix ? name.slice(1) : name);\n  }\n  if (Object.getOwnPropertySymbols) {\n    return names.concat(Object.getOwnPropertySymbols(events));\n  }\n  return names;\n};\n\n/**\n * Return the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Array} The registered listeners.\n * @public\n */\nEventEmitter.prototype.listeners = function listeners(event) {\n  var evt = prefix ? prefix + event : event,\n    handlers = this._events[evt];\n  if (!handlers) return [];\n  if (handlers.fn) return [handlers.fn];\n  for (var i = 0, l = handlers.length, ee = new Array(l); i < l; i++) {\n    ee[i] = handlers[i].fn;\n  }\n  return ee;\n};\n\n/**\n * Return the number of listeners listening to a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Number} The number of listeners.\n * @public\n */\nEventEmitter.prototype.listenerCount = function listenerCount(event) {\n  var evt = prefix ? prefix + event : event,\n    listeners = this._events[evt];\n  if (!listeners) return 0;\n  if (listeners.fn) return 1;\n  return listeners.length;\n};\n\n/**\n * Calls each of the listeners registered for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @returns {Boolean} `true` if the event had listeners, else `false`.\n * @public\n */\nEventEmitter.prototype.emit = function emit(event, a1, a2, a3, a4, a5) {\n  var evt = prefix ? prefix + event : event;\n  if (!this._events[evt]) return false;\n  var listeners = this._events[evt],\n    len = arguments.length,\n    args,\n    i;\n  if (listeners.fn) {\n    if (listeners.once) this.removeListener(event, listeners.fn, undefined, true);\n    switch (len) {\n      case 1:\n        return listeners.fn.call(listeners.context), true;\n      case 2:\n        return listeners.fn.call(listeners.context, a1), true;\n      case 3:\n        return listeners.fn.call(listeners.context, a1, a2), true;\n      case 4:\n        return listeners.fn.call(listeners.context, a1, a2, a3), true;\n      case 5:\n        return listeners.fn.call(listeners.context, a1, a2, a3, a4), true;\n      case 6:\n        return listeners.fn.call(listeners.context, a1, a2, a3, a4, a5), true;\n    }\n    for (i = 1, args = new Array(len - 1); i < len; i++) {\n      args[i - 1] = arguments[i];\n    }\n    listeners.fn.apply(listeners.context, args);\n  } else {\n    var length = listeners.length,\n      j;\n    for (i = 0; i < length; i++) {\n      if (listeners[i].once) this.removeListener(event, listeners[i].fn, undefined, true);\n      switch (len) {\n        case 1:\n          listeners[i].fn.call(listeners[i].context);\n          break;\n        case 2:\n          listeners[i].fn.call(listeners[i].context, a1);\n          break;\n        case 3:\n          listeners[i].fn.call(listeners[i].context, a1, a2);\n          break;\n        case 4:\n          listeners[i].fn.call(listeners[i].context, a1, a2, a3);\n          break;\n        default:\n          if (!args) for (j = 1, args = new Array(len - 1); j < len; j++) {\n            args[j - 1] = arguments[j];\n          }\n          listeners[i].fn.apply(listeners[i].context, args);\n      }\n    }\n  }\n  return true;\n};\n\n/**\n * Add a listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.on = function on(event, fn, context) {\n  return addListener(this, event, fn, context, false);\n};\n\n/**\n * Add a one-time listener for a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn The listener function.\n * @param {*} [context=this] The context to invoke the listener with.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.once = function once(event, fn, context) {\n  return addListener(this, event, fn, context, true);\n};\n\n/**\n * Remove the listeners of a given event.\n *\n * @param {(String|Symbol)} event The event name.\n * @param {Function} fn Only remove the listeners that match this function.\n * @param {*} context Only remove the listeners that have this context.\n * @param {Boolean} once Only remove one-time listeners.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeListener = function removeListener(event, fn, context, once) {\n  var evt = prefix ? prefix + event : event;\n  if (!this._events[evt]) return this;\n  if (!fn) {\n    clearEvent(this, evt);\n    return this;\n  }\n  var listeners = this._events[evt];\n  if (listeners.fn) {\n    if (listeners.fn === fn && (!once || listeners.once) && (!context || listeners.context === context)) {\n      clearEvent(this, evt);\n    }\n  } else {\n    for (var i = 0, events = [], length = listeners.length; i < length; i++) {\n      if (listeners[i].fn !== fn || once && !listeners[i].once || context && listeners[i].context !== context) {\n        events.push(listeners[i]);\n      }\n    }\n\n    //\n    // Reset the array, or remove it completely if we have no more listeners.\n    //\n    if (events.length) this._events[evt] = events.length === 1 ? events[0] : events;else clearEvent(this, evt);\n  }\n  return this;\n};\n\n/**\n * Remove all listeners, or those of the specified event.\n *\n * @param {(String|Symbol)} [event] The event name.\n * @returns {EventEmitter} `this`.\n * @public\n */\nEventEmitter.prototype.removeAllListeners = function removeAllListeners(event) {\n  var evt;\n  if (event) {\n    evt = prefix ? prefix + event : event;\n    if (this._events[evt]) clearEvent(this, evt);\n  } else {\n    this._events = new Events();\n    this._eventsCount = 0;\n  }\n  return this;\n};\n\n//\n// Alias methods names because people roll like that.\n//\nEventEmitter.prototype.off = EventEmitter.prototype.removeListener;\nEventEmitter.prototype.addListener = EventEmitter.prototype.on;\n\n//\n// Expose the prefix.\n//\nEventEmitter.prefixed = prefix;\n\n//\n// Allow `EventEmitter` to be imported as module namespace.\n//\nEventEmitter.EventEmitter = EventEmitter;\n\n//\n// Expose the module.\n//\nif ('undefined' !== typeof module) {\n  module.exports = EventEmitter;\n}", "/**\n * @greymass/buoy v1.0.4\n * https://github.com/greymass/buoy-client\n *\n * @license\n * Copyright (c) 2021 FFF00 Agents AB & Greymass Inc. All Rights Reserved.\n * \n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n * \n *  1. Redistribution of source code must retain the above copyright notice, this\n *     list of conditions and the following disclaimer.\n * \n *  2. Redistribution in binary form must reproduce the above copyright notice,\n *     this list of conditions and the following disclaimer in the documentation\n *     and/or other materials provided with the distribution.\n * \n *  3. Neither the name of the copyright holder nor the names of its contributors\n *     may be used to endorse or promote products derived from this software without\n *     specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE\n * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n * \n * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE\n * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.\n */\nimport EventEmitter from 'eventemitter3';\n\n/** Emitted when a network error occurs, can safely be ignored. */\nclass SocketError extends Error {\n  event;\n  code = 'E_NETWORK';\n  constructor(event) {\n    super('Socket error');\n    this.event = event;\n  }\n}\n/** Emitted when a message fails to parse or read, non-recoverable. */\nclass MessageError extends Error {\n  reason;\n  underlyingError;\n  code = 'E_MESSAGE';\n  constructor(reason, underlyingError) {\n    super(reason);\n    this.reason = reason;\n    this.underlyingError = underlyingError;\n  }\n}\nconst globalBuoy$1 = globalThis || window;\nvar ListenerEncoding;\n(function (ListenerEncoding) {\n  ListenerEncoding[\"binary\"] = \"binary\";\n  ListenerEncoding[\"text\"] = \"text\";\n  ListenerEncoding[\"json\"] = \"json\";\n})(ListenerEncoding || (ListenerEncoding = {}));\nclass Listener extends EventEmitter {\n  url;\n  active = false;\n  socket;\n  timer;\n  reconnectTimer;\n  encoding;\n  WebSocket;\n  constructor(options) {\n    super();\n    if (!options.service) {\n      throw new Error('Options must include a service url');\n    }\n    if (!options.channel) {\n      throw new Error('Options must include a channel name');\n    }\n    const baseUrl = options.service.replace(/^http/, 'ws').replace(/\\/$/, '');\n    this.url = `${baseUrl}/${options.channel}?v=2`;\n    this.encoding = options.encoding || ListenerEncoding.text;\n    this.WebSocket = options.WebSocket || globalBuoy$1.WebSocket;\n    if (options.autoConnect !== false) {\n      this.connect();\n    }\n  }\n  connect() {\n    if (this.active) return;\n    this.active = true;\n    let retries = 0;\n    let pingTimer;\n    const connect = () => {\n      const socket = new this.WebSocket(this.url);\n      socket.onmessage = event => {\n        if (typeof Blob !== 'undefined' && event.data instanceof Blob) {\n          const reader = new FileReader();\n          reader.onload = () => {\n            this.handleMessage(new Uint8Array(reader.result));\n          };\n          reader.onerror = () => {\n            this.emit('error', new MessageError('Could not read message'));\n          };\n          reader.readAsArrayBuffer(event.data);\n        } else if (typeof event.data === 'string') {\n          this.handleMessage(new TextEncoder().encode(event.data));\n        } else if (typeof globalBuoy$1.Buffer !== 'undefined' && (event.data instanceof globalBuoy$1.Buffer || Array.isArray(event.data))) {\n          let buffer = event.data;\n          if (!globalBuoy$1.Buffer.isBuffer(buffer)) {\n            buffer = globalBuoy$1.Buffer.concat(buffer);\n          }\n          this.handleMessage(new Uint8Array(buffer.buffer, buffer.byteOffset, buffer.byteLength));\n        } else if (event.data instanceof Uint8Array) {\n          this.handleMessage(event.data);\n        } else if (event.data instanceof ArrayBuffer) {\n          this.handleMessage(new Uint8Array(event.data));\n        } else {\n          this.emit('error', new MessageError('Unhandled event data type'));\n        }\n      };\n      socket.onerror = event => {\n        if (this.socket === socket && this.active) {\n          this.emit('error', new SocketError(event));\n        }\n      };\n      socket.onopen = () => {\n        retries = 0;\n        this.emit('connect');\n      };\n      socket.onclose = () => {\n        if (this.active) {\n          clearTimeout(this.timer);\n          this.timer = setTimeout(connect, backoff(retries++));\n        }\n        this.socket = undefined;\n        clearTimeout(pingTimer);\n        if (this.reconnectTimer) {\n          clearInterval(this.reconnectTimer);\n        }\n        this.emit('disconnect');\n      };\n      // Reconnect every 10 mins to keep the connection alive\n      this.setupReconnectionTimer();\n      // fix problem where node.js does not react to the socket going down\n      // this terminates the connection if we don't get a heartbeat in 15s (buoy-nodejs sends every 10s)\n      const nodeSocket = socket;\n      if (typeof nodeSocket.on === 'function' && typeof nodeSocket.terminate === 'function') {\n        nodeSocket.on('ping', () => {\n          clearTimeout(pingTimer);\n          pingTimer = setTimeout(() => {\n            nodeSocket.terminate();\n          }, 15 * 1000);\n        });\n      }\n      this.socket = socket;\n    };\n    connect();\n  }\n  disconnect() {\n    this.active = false;\n    if (this.socket && (this.socket.readyState === this.WebSocket.OPEN || this.socket.readyState === this.WebSocket.CONNECTING)) {\n      this.socket.close(1000);\n    }\n  }\n  get isConnected() {\n    return this.active && this.socket?.readyState == this.WebSocket.OPEN;\n  }\n  handleMessage(bytes) {\n    if (bytes[0] === 0x42 && bytes[1] === 0x42 && bytes[2] === 0x01) {\n      this.socket?.send(new Uint8Array([0x42, 0x42, 0x02, bytes[3]]));\n      bytes = bytes.subarray(4);\n    }\n    let message;\n    switch (this.encoding) {\n      case ListenerEncoding.binary:\n        message = bytes;\n        break;\n      case ListenerEncoding.text:\n        message = new TextDecoder().decode(bytes);\n        break;\n      case ListenerEncoding.json:\n        {\n          try {\n            message = JSON.parse(new TextDecoder().decode(bytes));\n          } catch (error) {\n            this.emit('error', new MessageError('Unable to decode JSON', error));\n            return;\n          }\n        }\n    }\n    this.emit('message', message);\n  }\n  setupReconnectionTimer() {\n    this.reconnectTimer = setInterval(() => {\n      this.socket?.close(1000);\n    }, 10 * 60 * 1000);\n  }\n}\n/**\n * Exponential backoff function that caps off at 5s after 10 tries.\n * @internal\n */\nfunction backoff(tries) {\n  return Math.min(Math.pow(tries * 7, 2), 5 * 1000);\n}\n\n/**\n * Receive a single message from a buoy channel.\n * @note Instantiate a [[Listener]] if you want to receive multiple messages over the same channel.\n */\nfunction receive(options, ctx) {\n  return new Promise((resolve, reject) => {\n    const listener = new Listener({\n      ...options,\n      autoConnect: true\n    });\n    let timer;\n    let lastError;\n    const done = (error, message) => {\n      clearTimeout(timer);\n      if (error) {\n        reject(error);\n      } else {\n        resolve(message);\n      }\n      listener.disconnect();\n    };\n    if (ctx) {\n      ctx.cancel = () => {\n        done(new MessageError('Cancelled', lastError));\n      };\n    }\n    if (options.timeout) {\n      timer = setTimeout(() => {\n        done(new MessageError('Timed out', lastError));\n      }, options.timeout);\n    }\n    listener.on('error', error => {\n      if (!(error instanceof SocketError)) {\n        done(error);\n      } else {\n        lastError = error;\n      }\n    });\n    listener.once('message', message => {\n      done(undefined, message);\n    });\n  });\n}\nconst globalBuoy = globalThis || window;\n/** Result of a [[send]] call. */\nvar SendResult;\n(function (SendResult) {\n  /** Message was sent but not yet delivered. */\n  SendResult[\"buffered\"] = \"buffered\";\n  /** Message was delivered to at least 1 listener on the channel. */\n  SendResult[\"delivered\"] = \"delivered\";\n})(SendResult || (SendResult = {}));\n/**\n * Sends a message to the channel.\n * @returns a promise that resolves to a [[SendResult]].\n * @throws if the message can't be delivered if [[SendOptions.requireDelivery]] is set.\n */\nasync function send(message, options) {\n  const fetch = options.fetch || globalBuoy.fetch;\n  const baseUrl = options.service.replace(/^ws/, 'http').replace(/\\/$/, '');\n  const url = `${baseUrl}/${options.channel}`;\n  const headers = {};\n  if (options.requireDelivery) {\n    if (!options.timeout) {\n      throw new Error('requireDelivery can only be used with timeout');\n    }\n    headers['X-Buoy-Wait'] = `${Math.ceil(options.timeout / 1000)}`;\n  } else if (options.timeout) {\n    headers['X-Buoy-Soft-Wait'] = `${Math.ceil(options.timeout / 1000)}`;\n  }\n  let body;\n  if (typeof message === 'string' || message instanceof Uint8Array) {\n    body = message;\n  } else {\n    body = JSON.stringify(message);\n  }\n  const response = await fetch(url, {\n    method: 'POST',\n    body,\n    headers\n  });\n  if (Math.floor(response.status / 100) !== 2) {\n    if (response.status === 408) {\n      throw new Error('Unable to deliver message');\n    } else if (response.status === 410) {\n      throw new Error('Request cancelled');\n    } else {\n      throw new Error(`Unexpected status code ${response.status}`);\n    }\n  }\n  return response.headers.get('X-Buoy-Delivery') || SendResult.buffered;\n}\nexport { Listener, ListenerEncoding, MessageError, SendResult, SocketError, receive, send };\n", "/**\n * @greymass/miniaes v1.0.0\n * https://github.com/greymass/miniaes-js\n *\n * @license\n * Copyright (c) 2021 FFF00 Agents AB & Greymass Inc. All Rights Reserved.\n * \n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n * \n *  1. Redistribution of source code must retain the above copyright notice, this\n *     list of conditions and the following disclaimer.\n * \n *  2. Redistribution in binary form must reproduce the above copyright notice,\n *     this list of conditions and the following disclaimer in the documentation\n *     and/or other materials provided with the distribution.\n * \n *  3. Neither the name of the copyright holder nor the names of its contributors\n *     may be used to endorse or promote products derived from this software without\n *     specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE\n * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n * \n * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE\n * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.\n */\n/* eslint-disable */\n/**\n * @file {@link http://asmjs.org Asm.js} implementation of the {@link https://en.wikipedia.org/wiki/Advanced_Encryption_Standard Advanced Encryption Standard}.\n * @author Artem S Vybornov <vybornov@gmail.com>\n * @license MIT\n */\nvar AES_asm = function () {\n  /**\n   * Galois Field stuff init flag\n   */\n  var ginit_done = false;\n\n  /**\n   * Galois Field exponentiation and logarithm tables for 3 (the generator)\n   */\n  var gexp3, glog3;\n\n  /**\n   * Init Galois Field tables\n   */\n  function ginit() {\n    gexp3 = [], glog3 = [];\n    var a = 1,\n      c,\n      d;\n    for (c = 0; c < 255; c++) {\n      gexp3[c] = a;\n\n      // Multiply by three\n      d = a & 0x80, a <<= 1, a &= 255;\n      if (d === 0x80) a ^= 0x1b;\n      a ^= gexp3[c];\n\n      // Set the log table value\n      glog3[gexp3[c]] = c;\n    }\n    gexp3[255] = gexp3[0];\n    glog3[0] = 0;\n    ginit_done = true;\n  }\n\n  /**\n   * Galois Field multiplication\n   * @param {number} a\n   * @param {number} b\n   * @return {number}\n   */\n  function gmul(a, b) {\n    var c = gexp3[(glog3[a] + glog3[b]) % 255];\n    if (a === 0 || b === 0) c = 0;\n    return c;\n  }\n\n  /**\n   * Galois Field reciprocal\n   * @param {number} a\n   * @return {number}\n   */\n  function ginv(a) {\n    var i = gexp3[255 - glog3[a]];\n    if (a === 0) i = 0;\n    return i;\n  }\n\n  /**\n   * AES stuff init flag\n   */\n  var aes_init_done = false;\n\n  /**\n   * Encryption, Decryption, S-Box and KeyTransform tables\n   *\n   * @type {number[]}\n   */\n  var aes_sbox;\n\n  /**\n   * @type {number[]}\n   */\n  var aes_sinv;\n\n  /**\n   * @type {number[][]}\n   */\n  var aes_enc;\n\n  /**\n   * @type {number[][]}\n   */\n  var aes_dec;\n\n  /**\n   * Init AES tables\n   */\n  function aes_init() {\n    if (!ginit_done) ginit();\n\n    // Calculates AES S-Box value\n    function _s(a) {\n      var c, s, x;\n      s = x = ginv(a);\n      for (c = 0; c < 4; c++) {\n        s = (s << 1 | s >>> 7) & 255;\n        x ^= s;\n      }\n      x ^= 99;\n      return x;\n    }\n\n    // Tables\n    aes_sbox = [], aes_sinv = [], aes_enc = [[], [], [], []], aes_dec = [[], [], [], []];\n    for (var i = 0; i < 256; i++) {\n      var s = _s(i);\n\n      // S-Box and its inverse\n      aes_sbox[i] = s;\n      aes_sinv[s] = i;\n\n      // Ecryption and Decryption tables\n      aes_enc[0][i] = gmul(2, s) << 24 | s << 16 | s << 8 | gmul(3, s);\n      aes_dec[0][s] = gmul(14, i) << 24 | gmul(9, i) << 16 | gmul(13, i) << 8 | gmul(11, i);\n      // Rotate tables\n      for (var t = 1; t < 4; t++) {\n        aes_enc[t][i] = aes_enc[t - 1][i] >>> 8 | aes_enc[t - 1][i] << 24;\n        aes_dec[t][s] = aes_dec[t - 1][s] >>> 8 | aes_dec[t - 1][s] << 24;\n      }\n    }\n    aes_init_done = true;\n  }\n\n  /**\n   * Asm.js module constructor.\n   *\n   * <p>\n   * Heap buffer layout by offset:\n   * <pre>\n   * 0x0000   encryption key schedule\n   * 0x0400   decryption key schedule\n   * 0x0800   sbox\n   * 0x0c00   inv sbox\n   * 0x1000   encryption tables\n   * 0x2000   decryption tables\n   * 0x3000   reserved (future GCM multiplication lookup table)\n   * 0x4000   data\n   * </pre>\n   * Don't touch anything before <code>0x400</code>.\n   * </p>\n   *\n   * @alias AES_asm\n   * @class\n   * @param foreign - <i>ignored</i>\n   * @param buffer - heap buffer to link with\n   * @type any\n   */\n  var wrapper = function (foreign, buffer) {\n    // Init AES stuff for the first time\n    if (!aes_init_done) aes_init();\n\n    // Fill up AES tables\n    var heap = new Uint32Array(buffer);\n    heap.set(aes_sbox, 0x0800 >> 2);\n    heap.set(aes_sinv, 0x0c00 >> 2);\n    for (var i = 0; i < 4; i++) {\n      heap.set(aes_enc[i], 0x1000 + 0x400 * i >> 2);\n      heap.set(aes_dec[i], 0x2000 + 0x400 * i >> 2);\n    }\n\n    /**\n     * Calculate AES key schedules.\n     * @instance\n     * @memberof AES_asm\n     * @param {number} ks - key size, 4/6/8 (for 128/192/256-bit key correspondingly)\n     * @param {number} k0 - key vector components\n     * @param {number} k1 - key vector components\n     * @param {number} k2 - key vector components\n     * @param {number} k3 - key vector components\n     * @param {number} k4 - key vector components\n     * @param {number} k5 - key vector components\n     * @param {number} k6 - key vector components\n     * @param {number} k7 - key vector components\n     */\n    function set_key(ks, k0, k1, k2, k3, k4, k5, k6, k7) {\n      var ekeys = heap.subarray(0x000, 60),\n        dkeys = heap.subarray(0x100, 0x100 + 60);\n\n      // Encryption key schedule\n      ekeys.set([k0, k1, k2, k3, k4, k5, k6, k7]);\n      for (var i = ks, rcon = 1; i < 4 * ks + 28; i++) {\n        var k = ekeys[i - 1];\n        if (i % ks === 0 || ks === 8 && i % ks === 4) {\n          k = aes_sbox[k >>> 24] << 24 ^ aes_sbox[k >>> 16 & 255] << 16 ^ aes_sbox[k >>> 8 & 255] << 8 ^ aes_sbox[k & 255];\n        }\n        if (i % ks === 0) {\n          k = k << 8 ^ k >>> 24 ^ rcon << 24;\n          rcon = rcon << 1 ^ (rcon & 0x80 ? 0x1b : 0);\n        }\n        ekeys[i] = ekeys[i - ks] ^ k;\n      }\n\n      // Decryption key schedule\n      for (var j = 0; j < i; j += 4) {\n        for (var jj = 0; jj < 4; jj++) {\n          var k = ekeys[i - (4 + j) + (4 - jj) % 4];\n          if (j < 4 || j >= i - 4) {\n            dkeys[j + jj] = k;\n          } else {\n            dkeys[j + jj] = aes_dec[0][aes_sbox[k >>> 24]] ^ aes_dec[1][aes_sbox[k >>> 16 & 255]] ^ aes_dec[2][aes_sbox[k >>> 8 & 255]] ^ aes_dec[3][aes_sbox[k & 255]];\n          }\n        }\n      }\n\n      // Set rounds number\n      asm.set_rounds(ks + 5);\n    }\n\n    // create library object with necessary properties\n    var stdlib = {\n      Uint8Array: Uint8Array,\n      Uint32Array: Uint32Array\n    };\n    var asm = function (stdlib, foreign, buffer) {\n      \"use asm\";\n\n      var S0 = 0,\n        S1 = 0,\n        S2 = 0,\n        S3 = 0,\n        I0 = 0,\n        I1 = 0,\n        I2 = 0,\n        I3 = 0,\n        N0 = 0,\n        N1 = 0,\n        N2 = 0,\n        N3 = 0,\n        M0 = 0,\n        M1 = 0,\n        M2 = 0,\n        M3 = 0,\n        H0 = 0,\n        H1 = 0,\n        H2 = 0,\n        H3 = 0,\n        R = 0;\n      var HEAP = new stdlib.Uint32Array(buffer),\n        DATA = new stdlib.Uint8Array(buffer);\n\n      /**\n       * AES core\n       * @param {number} k - precomputed key schedule offset\n       * @param {number} s - precomputed sbox table offset\n       * @param {number} t - precomputed round table offset\n       * @param {number} r - number of inner rounds to perform\n       * @param {number} x0 - 128-bit input block vector\n       * @param {number} x1 - 128-bit input block vector\n       * @param {number} x2 - 128-bit input block vector\n       * @param {number} x3 - 128-bit input block vector\n       */\n      function _core(k, s, t, r, x0, x1, x2, x3) {\n        k = k | 0;\n        s = s | 0;\n        t = t | 0;\n        r = r | 0;\n        x0 = x0 | 0;\n        x1 = x1 | 0;\n        x2 = x2 | 0;\n        x3 = x3 | 0;\n        var t1 = 0,\n          t2 = 0,\n          t3 = 0,\n          y0 = 0,\n          y1 = 0,\n          y2 = 0,\n          y3 = 0,\n          i = 0;\n        t1 = t | 0x400, t2 = t | 0x800, t3 = t | 0xc00;\n\n        // round 0\n        x0 = x0 ^ HEAP[(k | 0) >> 2], x1 = x1 ^ HEAP[(k | 4) >> 2], x2 = x2 ^ HEAP[(k | 8) >> 2], x3 = x3 ^ HEAP[(k | 12) >> 2];\n\n        // round 1..r\n        for (i = 16; (i | 0) <= r << 4; i = i + 16 | 0) {\n          y0 = HEAP[(t | x0 >> 22 & 1020) >> 2] ^ HEAP[(t1 | x1 >> 14 & 1020) >> 2] ^ HEAP[(t2 | x2 >> 6 & 1020) >> 2] ^ HEAP[(t3 | x3 << 2 & 1020) >> 2] ^ HEAP[(k | i | 0) >> 2], y1 = HEAP[(t | x1 >> 22 & 1020) >> 2] ^ HEAP[(t1 | x2 >> 14 & 1020) >> 2] ^ HEAP[(t2 | x3 >> 6 & 1020) >> 2] ^ HEAP[(t3 | x0 << 2 & 1020) >> 2] ^ HEAP[(k | i | 4) >> 2], y2 = HEAP[(t | x2 >> 22 & 1020) >> 2] ^ HEAP[(t1 | x3 >> 14 & 1020) >> 2] ^ HEAP[(t2 | x0 >> 6 & 1020) >> 2] ^ HEAP[(t3 | x1 << 2 & 1020) >> 2] ^ HEAP[(k | i | 8) >> 2], y3 = HEAP[(t | x3 >> 22 & 1020) >> 2] ^ HEAP[(t1 | x0 >> 14 & 1020) >> 2] ^ HEAP[(t2 | x1 >> 6 & 1020) >> 2] ^ HEAP[(t3 | x2 << 2 & 1020) >> 2] ^ HEAP[(k | i | 12) >> 2];\n          x0 = y0, x1 = y1, x2 = y2, x3 = y3;\n        }\n\n        // final round\n        S0 = HEAP[(s | x0 >> 22 & 1020) >> 2] << 24 ^ HEAP[(s | x1 >> 14 & 1020) >> 2] << 16 ^ HEAP[(s | x2 >> 6 & 1020) >> 2] << 8 ^ HEAP[(s | x3 << 2 & 1020) >> 2] ^ HEAP[(k | i | 0) >> 2], S1 = HEAP[(s | x1 >> 22 & 1020) >> 2] << 24 ^ HEAP[(s | x2 >> 14 & 1020) >> 2] << 16 ^ HEAP[(s | x3 >> 6 & 1020) >> 2] << 8 ^ HEAP[(s | x0 << 2 & 1020) >> 2] ^ HEAP[(k | i | 4) >> 2], S2 = HEAP[(s | x2 >> 22 & 1020) >> 2] << 24 ^ HEAP[(s | x3 >> 14 & 1020) >> 2] << 16 ^ HEAP[(s | x0 >> 6 & 1020) >> 2] << 8 ^ HEAP[(s | x1 << 2 & 1020) >> 2] ^ HEAP[(k | i | 8) >> 2], S3 = HEAP[(s | x3 >> 22 & 1020) >> 2] << 24 ^ HEAP[(s | x0 >> 14 & 1020) >> 2] << 16 ^ HEAP[(s | x1 >> 6 & 1020) >> 2] << 8 ^ HEAP[(s | x2 << 2 & 1020) >> 2] ^ HEAP[(k | i | 12) >> 2];\n      }\n\n      /**\n       * ECB mode encryption\n       * @param {number} x0 - 128-bit input block vector\n       * @param {number} x1 - 128-bit input block vector\n       * @param {number} x2 - 128-bit input block vector\n       * @param {number} x3 - 128-bit input block vector\n       */\n      // function _ecb_enc(x0, x1, x2, x3) {\n      //   x0 = x0 | 0;\n      //   x1 = x1 | 0;\n      //   x2 = x2 | 0;\n      //   x3 = x3 | 0;\n\n      //   _core(\n      //     0x0000, 0x0800, 0x1000,\n      //     R,\n      //     x0,\n      //     x1,\n      //     x2,\n      //     x3\n      //   );\n      // }\n\n      /**\n       * ECB mode decryption\n       * @param {number} x0 - 128-bit input block vector\n       * @param {number} x1 - 128-bit input block vector\n       * @param {number} x2 - 128-bit input block vector\n       * @param {number} x3 - 128-bit input block vector\n       */\n      // function _ecb_dec(x0, x1, x2, x3) {\n      //   x0 = x0 | 0;\n      //   x1 = x1 | 0;\n      //   x2 = x2 | 0;\n      //   x3 = x3 | 0;\n\n      //   var t = 0;\n\n      //   _core(\n      //     0x0400, 0x0c00, 0x2000,\n      //     R,\n      //     x0,\n      //     x3,\n      //     x2,\n      //     x1\n      //   );\n\n      //   t = S1, S1 = S3, S3 = t;\n      // }\n\n      /**\n       * CBC mode encryption\n       * @param {number} x0 - 128-bit input block vector\n       * @param {number} x1 - 128-bit input block vector\n       * @param {number} x2 - 128-bit input block vector\n       * @param {number} x3 - 128-bit input block vector\n       */\n      function _cbc_enc(x0, x1, x2, x3) {\n        x0 = x0 | 0;\n        x1 = x1 | 0;\n        x2 = x2 | 0;\n        x3 = x3 | 0;\n        _core(0x0000, 0x0800, 0x1000, R, I0 ^ x0, I1 ^ x1, I2 ^ x2, I3 ^ x3);\n        I0 = S0, I1 = S1, I2 = S2, I3 = S3;\n      }\n\n      /**\n       * CBC mode decryption\n       * @param {number} x0 - 128-bit input block vector\n       * @param {number} x1 - 128-bit input block vector\n       * @param {number} x2 - 128-bit input block vector\n       * @param {number} x3 - 128-bit input block vector\n       */\n      function _cbc_dec(x0, x1, x2, x3) {\n        x0 = x0 | 0;\n        x1 = x1 | 0;\n        x2 = x2 | 0;\n        x3 = x3 | 0;\n        var t = 0;\n        _core(0x0400, 0x0c00, 0x2000, R, x0, x3, x2, x1);\n        t = S1, S1 = S3, S3 = t;\n        S0 = S0 ^ I0, S1 = S1 ^ I1, S2 = S2 ^ I2, S3 = S3 ^ I3;\n        I0 = x0, I1 = x1, I2 = x2, I3 = x3;\n      }\n\n      /**\n       * CFB mode encryption\n       * @param {number} x0 - 128-bit input block vector\n       * @param {number} x1 - 128-bit input block vector\n       * @param {number} x2 - 128-bit input block vector\n       * @param {number} x3 - 128-bit input block vector\n       */\n      // function _cfb_enc(x0, x1, x2, x3) {\n      //   x0 = x0 | 0;\n      //   x1 = x1 | 0;\n      //   x2 = x2 | 0;\n      //   x3 = x3 | 0;\n\n      //   _core(\n      //     0x0000, 0x0800, 0x1000,\n      //     R,\n      //     I0,\n      //     I1,\n      //     I2,\n      //     I3\n      //   );\n\n      //   I0 = S0 = S0 ^ x0,\n      //     I1 = S1 = S1 ^ x1,\n      //     I2 = S2 = S2 ^ x2,\n      //     I3 = S3 = S3 ^ x3;\n      // }\n\n      /**\n       * CFB mode decryption\n       * @param {number} x0 - 128-bit input block vector\n       * @param {number} x1 - 128-bit input block vector\n       * @param {number} x2 - 128-bit input block vector\n       * @param {number} x3 - 128-bit input block vector\n       */\n      // function _cfb_dec(x0, x1, x2, x3) {\n      //   x0 = x0 | 0;\n      //   x1 = x1 | 0;\n      //   x2 = x2 | 0;\n      //   x3 = x3 | 0;\n\n      //   _core(\n      //     0x0000, 0x0800, 0x1000,\n      //     R,\n      //     I0,\n      //     I1,\n      //     I2,\n      //     I3\n      //   );\n\n      //   S0 = S0 ^ x0,\n      //     S1 = S1 ^ x1,\n      //     S2 = S2 ^ x2,\n      //     S3 = S3 ^ x3;\n\n      //   I0 = x0,\n      //     I1 = x1,\n      //     I2 = x2,\n      //     I3 = x3;\n      // }\n\n      /**\n       * OFB mode encryption / decryption\n       * @param {number} x0 - 128-bit input block vector\n       * @param {number} x1 - 128-bit input block vector\n       * @param {number} x2 - 128-bit input block vector\n       * @param {number} x3 - 128-bit input block vector\n       */\n      // function _ofb(x0, x1, x2, x3) {\n      //   x0 = x0 | 0;\n      //   x1 = x1 | 0;\n      //   x2 = x2 | 0;\n      //   x3 = x3 | 0;\n\n      //   _core(\n      //     0x0000, 0x0800, 0x1000,\n      //     R,\n      //     I0,\n      //     I1,\n      //     I2,\n      //     I3\n      //   );\n\n      //   I0 = S0,\n      //     I1 = S1,\n      //     I2 = S2,\n      //     I3 = S3;\n\n      //   S0 = S0 ^ x0,\n      //     S1 = S1 ^ x1,\n      //     S2 = S2 ^ x2,\n      //     S3 = S3 ^ x3;\n      // }\n\n      /**\n       * CTR mode encryption / decryption\n       * @param {number} x0 - 128-bit input block vector\n       * @param {number} x1 - 128-bit input block vector\n       * @param {number} x2 - 128-bit input block vector\n       * @param {number} x3 - 128-bit input block vector\n       */\n      // function _ctr(x0, x1, x2, x3) {\n      //   x0 = x0 | 0;\n      //   x1 = x1 | 0;\n      //   x2 = x2 | 0;\n      //   x3 = x3 | 0;\n\n      //   _core(\n      //     0x0000, 0x0800, 0x1000,\n      //     R,\n      //     N0,\n      //     N1,\n      //     N2,\n      //     N3\n      //   );\n\n      //   N3 = (~M3 & N3) | M3 & (N3 + 1);\n      //     N2 = (~M2 & N2) | M2 & (N2 + ((N3 | 0) == 0));\n      //     N1 = (~M1 & N1) | M1 & (N1 + ((N2 | 0) == 0));\n      //     N0 = (~M0 & N0) | M0 & (N0 + ((N1 | 0) == 0));\n\n      //   S0 = S0 ^ x0;\n      //     S1 = S1 ^ x1;\n      //     S2 = S2 ^ x2;\n      //     S3 = S3 ^ x3;\n      // }\n\n      /**\n       * GCM mode MAC calculation\n       * @param {number} x0 - 128-bit input block vector\n       * @param {number} x1 - 128-bit input block vector\n       * @param {number} x2 - 128-bit input block vector\n       * @param {number} x3 - 128-bit input block vector\n       */\n      function _gcm_mac(x0, x1, x2, x3) {\n        x0 = x0 | 0;\n        x1 = x1 | 0;\n        x2 = x2 | 0;\n        x3 = x3 | 0;\n        var y0 = 0,\n          y1 = 0,\n          y2 = 0,\n          y3 = 0,\n          z0 = 0,\n          z1 = 0,\n          z2 = 0,\n          z3 = 0,\n          i = 0,\n          c = 0;\n        x0 = x0 ^ I0, x1 = x1 ^ I1, x2 = x2 ^ I2, x3 = x3 ^ I3;\n        y0 = H0 | 0, y1 = H1 | 0, y2 = H2 | 0, y3 = H3 | 0;\n        for (; (i | 0) < 128; i = i + 1 | 0) {\n          if (y0 >>> 31) {\n            z0 = z0 ^ x0, z1 = z1 ^ x1, z2 = z2 ^ x2, z3 = z3 ^ x3;\n          }\n          y0 = y0 << 1 | y1 >>> 31, y1 = y1 << 1 | y2 >>> 31, y2 = y2 << 1 | y3 >>> 31, y3 = y3 << 1;\n          c = x3 & 1;\n          x3 = x3 >>> 1 | x2 << 31, x2 = x2 >>> 1 | x1 << 31, x1 = x1 >>> 1 | x0 << 31, x0 = x0 >>> 1;\n          if (c) x0 = x0 ^ 0xe1000000;\n        }\n        I0 = z0, I1 = z1, I2 = z2, I3 = z3;\n      }\n\n      /**\n       * Set the internal rounds number.\n       * @instance\n       * @memberof AES_asm\n       * @param {number} r - number if inner AES rounds\n       */\n      function set_rounds(r) {\n        r = r | 0;\n        R = r;\n      }\n\n      /**\n       * Populate the internal state of the module.\n       * @instance\n       * @memberof AES_asm\n       * @param {number} s0 - state vector\n       * @param {number} s1 - state vector\n       * @param {number} s2 - state vector\n       * @param {number} s3 - state vector\n       */\n      function set_state(s0, s1, s2, s3) {\n        s0 = s0 | 0;\n        s1 = s1 | 0;\n        s2 = s2 | 0;\n        s3 = s3 | 0;\n        S0 = s0, S1 = s1, S2 = s2, S3 = s3;\n      }\n\n      /**\n       * Populate the internal iv of the module.\n       * @instance\n       * @memberof AES_asm\n       * @param {number} i0 - iv vector\n       * @param {number} i1 - iv vector\n       * @param {number} i2 - iv vector\n       * @param {number} i3 - iv vector\n       */\n      function set_iv(i0, i1, i2, i3) {\n        i0 = i0 | 0;\n        i1 = i1 | 0;\n        i2 = i2 | 0;\n        i3 = i3 | 0;\n        I0 = i0, I1 = i1, I2 = i2, I3 = i3;\n      }\n\n      /**\n       * Set nonce for CTR-family modes.\n       * @instance\n       * @memberof AES_asm\n       * @param {number} n0 - nonce vector\n       * @param {number} n1 - nonce vector\n       * @param {number} n2 - nonce vector\n       * @param {number} n3 - nonce vector\n       */\n      function set_nonce(n0, n1, n2, n3) {\n        n0 = n0 | 0;\n        n1 = n1 | 0;\n        n2 = n2 | 0;\n        n3 = n3 | 0;\n        N0 = n0, N1 = n1, N2 = n2, N3 = n3;\n      }\n\n      /**\n       * Set counter mask for CTR-family modes.\n       * @instance\n       * @memberof AES_asm\n       * @param {number} m0 - counter mask vector\n       * @param {number} m1 - counter mask vector\n       * @param {number} m2 - counter mask vector\n       * @param {number} m3 - counter mask vector\n       */\n      function set_mask(m0, m1, m2, m3) {\n        m0 = m0 | 0;\n        m1 = m1 | 0;\n        m2 = m2 | 0;\n        m3 = m3 | 0;\n        M0 = m0, M1 = m1, M2 = m2, M3 = m3;\n      }\n\n      /**\n       * Set counter for CTR-family modes.\n       * @instance\n       * @memberof AES_asm\n       * @param {number} c0 - counter vector\n       * @param {number} c1 - counter vector\n       * @param {number} c2 - counter vector\n       * @param {number} c3 - counter vector\n       */\n      function set_counter(c0, c1, c2, c3) {\n        c0 = c0 | 0;\n        c1 = c1 | 0;\n        c2 = c2 | 0;\n        c3 = c3 | 0;\n        N3 = ~M3 & N3 | M3 & c3, N2 = ~M2 & N2 | M2 & c2, N1 = ~M1 & N1 | M1 & c1, N0 = ~M0 & N0 | M0 & c0;\n      }\n\n      /**\n       * Store the internal state vector into the heap.\n       * @instance\n       * @memberof AES_asm\n       * @param {number} pos - offset where to put the data\n       * @return {number} The number of bytes have been written into the heap, always 16.\n       */\n      function get_state(pos) {\n        pos = pos | 0;\n        if (pos & 15) return -1;\n        DATA[pos | 0] = S0 >>> 24, DATA[pos | 1] = S0 >>> 16 & 255, DATA[pos | 2] = S0 >>> 8 & 255, DATA[pos | 3] = S0 & 255, DATA[pos | 4] = S1 >>> 24, DATA[pos | 5] = S1 >>> 16 & 255, DATA[pos | 6] = S1 >>> 8 & 255, DATA[pos | 7] = S1 & 255, DATA[pos | 8] = S2 >>> 24, DATA[pos | 9] = S2 >>> 16 & 255, DATA[pos | 10] = S2 >>> 8 & 255, DATA[pos | 11] = S2 & 255, DATA[pos | 12] = S3 >>> 24, DATA[pos | 13] = S3 >>> 16 & 255, DATA[pos | 14] = S3 >>> 8 & 255, DATA[pos | 15] = S3 & 255;\n        return 16;\n      }\n\n      /**\n       * Store the internal iv vector into the heap.\n       * @instance\n       * @memberof AES_asm\n       * @param {number} pos - offset where to put the data\n       * @return {number} The number of bytes have been written into the heap, always 16.\n       */\n      function get_iv(pos) {\n        pos = pos | 0;\n        if (pos & 15) return -1;\n        DATA[pos | 0] = I0 >>> 24, DATA[pos | 1] = I0 >>> 16 & 255, DATA[pos | 2] = I0 >>> 8 & 255, DATA[pos | 3] = I0 & 255, DATA[pos | 4] = I1 >>> 24, DATA[pos | 5] = I1 >>> 16 & 255, DATA[pos | 6] = I1 >>> 8 & 255, DATA[pos | 7] = I1 & 255, DATA[pos | 8] = I2 >>> 24, DATA[pos | 9] = I2 >>> 16 & 255, DATA[pos | 10] = I2 >>> 8 & 255, DATA[pos | 11] = I2 & 255, DATA[pos | 12] = I3 >>> 24, DATA[pos | 13] = I3 >>> 16 & 255, DATA[pos | 14] = I3 >>> 8 & 255, DATA[pos | 15] = I3 & 255;\n        return 16;\n      }\n\n      /**\n       * GCM initialization.\n       * @instance\n       * @memberof AES_asm\n       */\n      // function gcm_init() {\n      //   _ecb_enc(0, 0, 0, 0);\n      //   H0 = S0,\n      //     H1 = S1,\n      //     H2 = S2,\n      //     H3 = S3;\n      // }\n\n      /**\n       * Perform ciphering operation on the supplied data.\n       * @instance\n       * @memberof AES_asm\n       * @param {number} mode - block cipher mode (see {@link AES_asm} mode constants)\n       * @param {number} pos - offset of the data being processed\n       * @param {number} len - length of the data being processed\n       * @return {number} Actual amount of data have been processed.\n       */\n      function cipher(mode, pos, len) {\n        mode = mode | 0;\n        pos = pos | 0;\n        len = len | 0;\n        var ret = 0;\n        if (pos & 15) return -1;\n        while ((len | 0) >= 16) {\n          _cipher_modes[mode & 7](DATA[pos | 0] << 24 | DATA[pos | 1] << 16 | DATA[pos | 2] << 8 | DATA[pos | 3], DATA[pos | 4] << 24 | DATA[pos | 5] << 16 | DATA[pos | 6] << 8 | DATA[pos | 7], DATA[pos | 8] << 24 | DATA[pos | 9] << 16 | DATA[pos | 10] << 8 | DATA[pos | 11], DATA[pos | 12] << 24 | DATA[pos | 13] << 16 | DATA[pos | 14] << 8 | DATA[pos | 15]);\n          DATA[pos | 0] = S0 >>> 24, DATA[pos | 1] = S0 >>> 16 & 255, DATA[pos | 2] = S0 >>> 8 & 255, DATA[pos | 3] = S0 & 255, DATA[pos | 4] = S1 >>> 24, DATA[pos | 5] = S1 >>> 16 & 255, DATA[pos | 6] = S1 >>> 8 & 255, DATA[pos | 7] = S1 & 255, DATA[pos | 8] = S2 >>> 24, DATA[pos | 9] = S2 >>> 16 & 255, DATA[pos | 10] = S2 >>> 8 & 255, DATA[pos | 11] = S2 & 255, DATA[pos | 12] = S3 >>> 24, DATA[pos | 13] = S3 >>> 16 & 255, DATA[pos | 14] = S3 >>> 8 & 255, DATA[pos | 15] = S3 & 255;\n          ret = ret + 16 | 0, pos = pos + 16 | 0, len = len - 16 | 0;\n        }\n        return ret | 0;\n      }\n\n      /**\n       * Calculates MAC of the supplied data.\n       * @instance\n       * @memberof AES_asm\n       * @param {number} mode - block cipher mode (see {@link AES_asm} mode constants)\n       * @param {number} pos - offset of the data being processed\n       * @param {number} len - length of the data being processed\n       * @return {number} Actual amount of data have been processed.\n       */\n      function mac(mode, pos, len) {\n        mode = mode | 0;\n        pos = pos | 0;\n        len = len | 0;\n        var ret = 0;\n        if (pos & 15) return -1;\n        while ((len | 0) >= 16) {\n          _mac_modes[mode & 1](DATA[pos | 0] << 24 | DATA[pos | 1] << 16 | DATA[pos | 2] << 8 | DATA[pos | 3], DATA[pos | 4] << 24 | DATA[pos | 5] << 16 | DATA[pos | 6] << 8 | DATA[pos | 7], DATA[pos | 8] << 24 | DATA[pos | 9] << 16 | DATA[pos | 10] << 8 | DATA[pos | 11], DATA[pos | 12] << 24 | DATA[pos | 13] << 16 | DATA[pos | 14] << 8 | DATA[pos | 15]);\n          ret = ret + 16 | 0, pos = pos + 16 | 0, len = len - 16 | 0;\n        }\n        return ret | 0;\n      }\n\n      /**\n       * AES cipher modes table (virual methods)\n       */\n      var _cipher_modes = [_cbc_enc, _cbc_enc, _cbc_enc, _cbc_dec, _cbc_dec, _cbc_dec, _cbc_dec, _cbc_dec];\n\n      /**\n       * AES MAC modes table (virual methods)\n       */\n      var _mac_modes = [_cbc_enc, _cbc_enc];\n\n      /**\n       * Asm.js module exports\n       */\n      return {\n        set_rounds: set_rounds,\n        set_state: set_state,\n        set_iv: set_iv,\n        set_nonce: set_nonce,\n        set_mask: set_mask,\n        set_counter: set_counter,\n        get_state: get_state,\n        get_iv: get_iv,\n        // gcm_init: gcm_init,\n        cipher: cipher,\n        mac: mac\n      };\n    }(stdlib, foreign, buffer);\n    asm.set_key = set_key;\n    return asm;\n  };\n\n  /**\n   * AES enciphering mode constants\n   * @enum {number}\n   * @const\n   */\n  wrapper.ENC = {\n    //ECB: 0,\n    CBC: 2\n    //CFB: 4,\n    //OFB: 6,\n    // CTR: 7,\n  },\n  /**\n   * AES deciphering mode constants\n   * @enum {number}\n   * @const\n   */\n  wrapper.DEC = {\n    //ECB: 1,\n    CBC: 3\n    //CFB: 5,\n    //OFB: 6,\n    // CTR: 7,\n  },\n  /**\n   * AES MAC mode constants\n   * @enum {number}\n   * @const\n   */\n  wrapper.MAC = {\n    CBC: 0\n    //GCM: 1,\n  };\n\n  /**\n   * Heap data offset\n   * @type {number}\n   * @const\n   */\n  wrapper.HEAP_DATA = 0x4000;\n  return wrapper;\n}();\nfunction _heap_init(heap, heapSize) {\n  const size = heap ? heap.byteLength : heapSize || 65536;\n  if (size & 0xfff || size <= 0) throw new Error('heap size must be a positive integer and a multiple of 4096');\n  heap = heap || new Uint8Array(new ArrayBuffer(size));\n  return heap;\n}\nfunction _heap_write(heap, hpos, data, dpos, dlen) {\n  const hlen = heap.length - hpos;\n  const wlen = hlen < dlen ? hlen : dlen;\n  heap.set(data.subarray(dpos, dpos + wlen), hpos);\n  return wlen;\n}\nfunction is_bytes(a) {\n  return a instanceof Uint8Array;\n}\nfunction joinBytes(...arg) {\n  const totalLength = arg.reduce((sum, curr) => sum + curr.length, 0);\n  const ret = new Uint8Array(totalLength);\n  let cursor = 0;\n  for (let i = 0; i < arg.length; i++) {\n    ret.set(arg[i], cursor);\n    cursor += arg[i].length;\n  }\n  return ret;\n}\nclass AES {\n  constructor(key, iv, padding = true, mode) {\n    this.pos = 0;\n    this.len = 0;\n    this.mode = mode;\n    // The AES \"worker\"\n    this.heap = _heap_init().subarray(AES_asm.HEAP_DATA);\n    this.asm = new AES_asm(null, this.heap.buffer);\n    // The AES object state\n    this.pos = 0;\n    this.len = 0;\n    // Key\n    const keylen = key.length;\n    if (keylen !== 16 && keylen !== 24 && keylen !== 32) throw new TypeError('illegal key size');\n    const keyview = new DataView(key.buffer, key.byteOffset, key.byteLength);\n    this.asm.set_key(keylen >> 2, keyview.getUint32(0), keyview.getUint32(4), keyview.getUint32(8), keyview.getUint32(12), keylen > 16 ? keyview.getUint32(16) : 0, keylen > 16 ? keyview.getUint32(20) : 0, keylen > 24 ? keyview.getUint32(24) : 0, keylen > 24 ? keyview.getUint32(28) : 0);\n    // IV\n    if (iv !== undefined) {\n      if (iv.length !== 16) throw new TypeError('illegal iv size');\n      const ivview = new DataView(iv.buffer, iv.byteOffset, iv.byteLength);\n      this.asm.set_iv(ivview.getUint32(0), ivview.getUint32(4), ivview.getUint32(8), ivview.getUint32(12));\n    } else {\n      this.asm.set_iv(0, 0, 0, 0);\n    }\n    this.padding = padding;\n  }\n  AES_Encrypt_process(data) {\n    if (!is_bytes(data)) throw new TypeError(\"data isn't of expected type\");\n    const asm = this.asm;\n    const heap = this.heap;\n    const amode = AES_asm.ENC[this.mode];\n    const hpos = AES_asm.HEAP_DATA;\n    let pos = this.pos;\n    let len = this.len;\n    let dpos = 0;\n    let dlen = data.length || 0;\n    let rpos = 0;\n    const rlen = len + dlen & -16;\n    let wlen = 0;\n    const result = new Uint8Array(rlen);\n    while (dlen > 0) {\n      wlen = _heap_write(heap, pos + len, data, dpos, dlen);\n      len += wlen;\n      dpos += wlen;\n      dlen -= wlen;\n      wlen = asm.cipher(amode, hpos + pos, len);\n      if (wlen) result.set(heap.subarray(pos, pos + wlen), rpos);\n      rpos += wlen;\n      if (wlen < len) {\n        pos += wlen;\n        len -= wlen;\n      } else {\n        pos = 0;\n        len = 0;\n      }\n    }\n    this.pos = pos;\n    this.len = len;\n    return result;\n  }\n  AES_Encrypt_finish() {\n    const asm = this.asm;\n    const heap = this.heap;\n    const amode = AES_asm.ENC[this.mode];\n    const hpos = AES_asm.HEAP_DATA;\n    const pos = this.pos;\n    let len = this.len;\n    const plen = 16 - len % 16;\n    let rlen = len;\n    // if (this.hasOwnProperty('padding')) {\n    if (this.padding) {\n      for (let p = 0; p < plen; ++p) {\n        heap[pos + len + p] = plen;\n      }\n      len += plen;\n      rlen = len;\n    } else if (len % 16) {\n      throw new TypeError('data length must be a multiple of the block size');\n    }\n    // } else {\n    //     len += plen\n    // }\n    const result = new Uint8Array(rlen);\n    if (len) asm.cipher(amode, hpos + pos, len);\n    if (rlen) result.set(heap.subarray(pos, pos + rlen));\n    this.pos = 0;\n    this.len = 0;\n    return result;\n  }\n  AES_Decrypt_process(data) {\n    if (!is_bytes(data)) throw new TypeError(\"data isn't of expected type\");\n    const asm = this.asm;\n    const heap = this.heap;\n    const amode = AES_asm.DEC[this.mode];\n    const hpos = AES_asm.HEAP_DATA;\n    let pos = this.pos;\n    let len = this.len;\n    let dpos = 0;\n    let dlen = data.length || 0;\n    let rpos = 0;\n    let rlen = len + dlen & -16;\n    let plen = 0;\n    let wlen = 0;\n    if (this.padding) {\n      plen = len + dlen - rlen || 16;\n      rlen -= plen;\n    }\n    const result = new Uint8Array(rlen);\n    while (dlen > 0) {\n      wlen = _heap_write(heap, pos + len, data, dpos, dlen);\n      len += wlen;\n      dpos += wlen;\n      dlen -= wlen;\n      wlen = asm.cipher(amode, hpos + pos, len - (!dlen ? plen : 0));\n      if (wlen) result.set(heap.subarray(pos, pos + wlen), rpos);\n      rpos += wlen;\n      if (wlen < len) {\n        pos += wlen;\n        len -= wlen;\n      } else {\n        pos = 0;\n        len = 0;\n      }\n    }\n    this.pos = pos;\n    this.len = len;\n    return result;\n  }\n  AES_Decrypt_finish() {\n    const asm = this.asm;\n    const heap = this.heap;\n    const amode = AES_asm.DEC[this.mode];\n    const hpos = AES_asm.HEAP_DATA;\n    const pos = this.pos;\n    const len = this.len;\n    let rlen = len;\n    if (len > 0) {\n      if (len % 16) {\n        // if (this.hasOwnProperty('padding')) {\n        throw new Error('data length must be a multiple of the block size');\n        // } else {\n        // len += 16 - (len % 16)\n        // }\n      }\n      asm.cipher(amode, hpos + pos, len);\n      if (/*this.hasOwnProperty('padding')  &&*/this.padding) {\n        const pad = heap[pos + rlen - 1];\n        if (pad < 1 || pad > 16 || pad > rlen) throw new Error('bad padding');\n        let pcheck = 0;\n        for (let i = pad; i > 1; i--) pcheck |= pad ^ heap[pos + rlen - i];\n        if (pcheck) throw new Error('bad padding');\n        rlen -= pad;\n      }\n    }\n    const result = new Uint8Array(rlen);\n    if (rlen > 0) {\n      result.set(heap.subarray(pos, pos + rlen));\n    }\n    this.pos = 0;\n    this.len = 0;\n    return result;\n  }\n}\nclass AES_CBC {\n  constructor(key, iv, padding = true, aes) {\n    this.aes = aes ? aes : new AES(key, iv, padding, 'CBC');\n  }\n  static encrypt(data, key, padding = true, iv) {\n    return new AES_CBC(key, iv, padding).encrypt(data);\n  }\n  static decrypt(data, key, padding = true, iv) {\n    return new AES_CBC(key, iv, padding).decrypt(data);\n  }\n  encrypt(data) {\n    const r1 = this.aes.AES_Encrypt_process(data);\n    const r2 = this.aes.AES_Encrypt_finish();\n    return joinBytes(r1, r2);\n  }\n  decrypt(data) {\n    const r1 = this.aes.AES_Decrypt_process(data);\n    const r2 = this.aes.AES_Decrypt_finish();\n    return joinBytes(r1, r2);\n  }\n}\nexport { AES, AES_CBC };\n", "/**\n * @wharfkit/protocol-esr v1.4.0\n * https://github.com/wharfkit/protocol-esr\n *\n * @license\n * Copyright (c) 2023 Greymass Inc. All Rights Reserved.\n * \n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n * \n * 1.  Redistribution of source code must retain the above copyright notice, this\n *     list of conditions and the following disclaimer.\n * \n * 2.  Redistribution in binary form must reproduce the above copyright notice,\n *     this list of conditions and the following disclaimer in the documentation\n *     and/or other materials provided with the distribution.\n * \n * 3.  Neither the name of the copyright holder nor the names of its contributors\n *     may be used to endorse or promote products derived from this software without\n *     specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE\n * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n * \n * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE\n * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.\n */\nimport { Struct, PrivateKey, ChainId, SigningRequest, UInt64, Checksum512, Serializer, Bytes, Checksum256, Signature } from '@wharfkit/session';\nimport { receive } from '@greymass/buoy';\nimport { AES_CBC } from '@greymass/miniaes';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\nfunction __decorate(decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\ntypeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\nlet SealedMessage = class SealedMessage extends Struct {};\n__decorate([Struct.field('public_key')], SealedMessage.prototype, \"from\", void 0);\n__decorate([Struct.field('uint64')], SealedMessage.prototype, \"nonce\", void 0);\n__decorate([Struct.field('bytes')], SealedMessage.prototype, \"ciphertext\", void 0);\n__decorate([Struct.field('uint32')], SealedMessage.prototype, \"checksum\", void 0);\nSealedMessage = __decorate([Struct.type('sealed_message')], SealedMessage);\nlet LinkCreate = class LinkCreate extends Struct {};\n__decorate([Struct.field('name')], LinkCreate.prototype, \"session_name\", void 0);\n__decorate([Struct.field('public_key')], LinkCreate.prototype, \"request_key\", void 0);\n__decorate([Struct.field('string', {\n  extension: true\n})], LinkCreate.prototype, \"user_agent\", void 0);\nLinkCreate = __decorate([Struct.type('link_create')], LinkCreate);\nlet LinkInfo = class LinkInfo extends Struct {};\n__decorate([Struct.field('time_point_sec')], LinkInfo.prototype, \"expiration\", void 0);\nLinkInfo = __decorate([Struct.type('link_info')], LinkInfo);\nlet BuoyMessage = class BuoyMessage extends Struct {};\n__decorate([Struct.field('public_key')], BuoyMessage.prototype, \"from\", void 0);\n__decorate([Struct.field('uint64')], BuoyMessage.prototype, \"nonce\", void 0);\n__decorate([Struct.field('bytes')], BuoyMessage.prototype, \"ciphertext\", void 0);\n__decorate([Struct.field('uint32')], BuoyMessage.prototype, \"checksum\", void 0);\nBuoyMessage = __decorate([Struct.type('buoy_message')], BuoyMessage);\nlet BuoySession = class BuoySession extends Struct {};\n__decorate([Struct.field('name')], BuoySession.prototype, \"session_name\", void 0);\n__decorate([Struct.field('public_key')], BuoySession.prototype, \"request_key\", void 0);\n__decorate([Struct.field('string', {\n  extension: true\n})], BuoySession.prototype, \"user_agent\", void 0);\nBuoySession = __decorate([Struct.type('buoy_session')], BuoySession);\nlet BuoyInfo = class BuoyInfo extends Struct {};\n__decorate([Struct.field('time_point_sec')], BuoyInfo.prototype, \"expiration\", void 0);\nBuoyInfo = __decorate([Struct.type('buoy_info')], BuoyInfo);\nasync function waitForCallback(callbackArgs, buoyWs, t) {\n  // Use the buoy-client to create a promise and wait for a response to the identity request\n  const callbackResponse = await receive({\n    ...callbackArgs,\n    WebSocket: buoyWs || WebSocket\n  });\n  if (!callbackResponse) {\n    // If the promise was rejected, throw an error\n    throw new Error(callbackResponse.rejected);\n  }\n  // If the promise was rejected, throw an error\n  if (typeof callbackResponse.rejected === 'string') {\n    throw new Error(callbackResponse.rejected);\n  }\n  // Process the identity request callback payload\n  const payload = JSON.parse(callbackResponse);\n  if (payload.sa === undefined || payload.sp === undefined || payload.cid === undefined) {\n    throw new Error(t('error.cancelled', {\n      default: 'The request was cancelled from Anchor.'\n    }));\n  }\n  return payload;\n}\n\n/**\n * Return PascalCase version of snake_case string.\n * @internal\n */\nfunction snakeToPascal(name) {\n  return name.split('_').map(v => (v[0] ? v[0].toUpperCase() : '') + v.slice(1)).join('');\n}\n/**\n * Return camelCase version of snake_case string.\n * @internal\n */\nfunction snakeToCamel(name) {\n  const pascal = snakeToPascal(name);\n  return (pascal[0] ? pascal[0].toLowerCase() : '') + pascal.slice(1);\n}\n/**\n * Print a warning message to console.\n * @internal\n **/\nfunction logWarn(...args) {\n  // eslint-disable-next-line no-console\n  console.warn('[anchor-link]', ...args);\n}\n/**\n * Generate a UUID.\n *  @internal\n * */\nfunction uuid() {\n  let uuid = '',\n    ii;\n  const chars = '0123456789abcdef';\n  for (ii = 0; ii < 36; ii += 1) {\n    switch (ii) {\n      case 8:\n      case 13:\n      case 18:\n      case 23:\n        uuid += '-';\n        break;\n      case 14:\n        uuid += '4';\n        break;\n      case 19:\n        uuid += chars[Math.random() * 4 | 0 + 8];\n        break;\n      default:\n        uuid += chars[Math.random() * 16 | 0];\n    }\n  }\n  return uuid;\n}\n/** Generate a return url that Anchor will redirect back to w/o reload. */\nfunction generateReturnUrl() {\n  // Return undefined for iOS React Native apps to prevent redirect to Safari\n  if (isAppleHandheld() && isReactNativeApp()) {\n    return undefined;\n  }\n  if (isChromeiOS()) {\n    // google chrome on iOS will always open new tab so we just ask it to open again as a workaround\n    return 'googlechrome://';\n  }\n  if (isFirefoxiOS()) {\n    // same for firefox\n    return 'firefox:://';\n  }\n  if (isAppleHandheld() && isBrave()) {\n    // and brave ios\n    return 'brave://';\n  }\n  if (isAppleHandheld()) {\n    // return url with unique fragment required for iOS safari to trigger the return url\n    const alphabet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    let rv = window.location.href.split('#')[0] + '#';\n    for (let i = 0; i < 8; i++) {\n      rv += alphabet.charAt(Math.floor(Math.random() * alphabet.length));\n    }\n    return rv;\n  }\n  if (isAndroid() && isFirefox()) {\n    return 'android-app://org.mozilla.firefox';\n  }\n  if (isAndroid() && isEdge()) {\n    return 'android-app://com.microsoft.emmx';\n  }\n  if (isAndroid() && isOpera()) {\n    return 'android-app://com.opera.browser';\n  }\n  if (isAndroid() && isBrave()) {\n    return 'android-app://com.brave.browser';\n  }\n  if (isAndroid() && isAndroidWebView()) {\n    return 'android-app://webview';\n  }\n  if (isAndroid() && isChromeMobile()) {\n    return 'android-app://com.android.chrome';\n  }\n  return window.location.href;\n}\nfunction isAppleHandheld() {\n  return /iP(ad|od|hone)/i.test(navigator.userAgent);\n}\nfunction isChromeiOS() {\n  return /CriOS/.test(navigator.userAgent);\n}\nfunction isChromeMobile() {\n  return /Chrome\\/[.0-9]* Mobile/i.test(navigator.userAgent);\n}\nfunction isFirefox() {\n  return /Firefox/i.test(navigator.userAgent);\n}\nfunction isFirefoxiOS() {\n  return /FxiOS/.test(navigator.userAgent);\n}\nfunction isOpera() {\n  return /OPR/.test(navigator.userAgent) || /Opera/.test(navigator.userAgent);\n}\nfunction isEdge() {\n  return /Edg/.test(navigator.userAgent);\n}\nfunction isBrave() {\n  return navigator['brave'] && typeof navigator['brave'].isBrave === 'function';\n}\nfunction isAndroid() {\n  return /Android/.test(navigator.userAgent);\n}\nfunction isReactNativeApp() {\n  // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n  // @ts-ignore\n  return !!window.ReactNativeWebView;\n}\nfunction isAndroidWebView() {\n  return /wv/.test(navigator.userAgent) || /Android/.test(navigator.userAgent) && isReactNativeApp();\n}\nfunction isKnownMobile() {\n  return isAppleHandheld() || isChromeiOS() || isChromeMobile() || isFirefoxiOS() || isAndroid() || isAndroidWebView();\n}\n\n/**\n * createIdentityRequest\n *\n * @param context LoginContext\n * @returns\n */\nasync function createIdentityRequest(context, buoyUrl) {\n  // Create a new private key and public key to act as the request key\n  const privateKey = PrivateKey.generate('K1');\n  const requestKey = privateKey.toPublic();\n  // Create a new BuoySession struct to be used as the info field\n  const createInfo = BuoySession.from({\n    session_name: context.appName,\n    request_key: requestKey,\n    user_agent: getUserAgent()\n  });\n  // Determine based on the options whether this is a multichain request\n  const isMultiChain = !(context.chain || context.chains.length === 1);\n  // Create the callback\n  const callbackChannel = prepareCallbackChannel(buoyUrl);\n  // Determine the chain id(s) to use\n  const chainId = isMultiChain ? null : context.chain ? ChainId.from(context.chain.id.array) : null;\n  const chainIds = isMultiChain ? context.chains.map(c => ChainId.from(c.id.array)) : [];\n  // Create the request\n  const request = SigningRequest.identity({\n    callback: prepareCallback(callbackChannel),\n    scope: String(context.appName),\n    chainId,\n    chainIds,\n    info: {\n      link: createInfo,\n      scope: String(context.appName)\n    }\n  }, context.esrOptions);\n  const sameDeviceRequest = request.clone();\n  if (typeof window !== 'undefined') {\n    const returnUrl = generateReturnUrl();\n    sameDeviceRequest.setInfoKey('same_device', true);\n    if (returnUrl !== undefined) {\n      sameDeviceRequest.setInfoKey('return_path', returnUrl);\n    }\n  }\n  // Return the request and the callback data\n  return {\n    callback: callbackChannel,\n    request,\n    sameDeviceRequest,\n    requestKey,\n    privateKey\n  };\n}\n/**\n * prepareTransactionRequest\n *\n * @param resolved ResolvedSigningRequest\n * @returns\n */\nfunction setTransactionCallback(request, buoyUrl) {\n  const callback = prepareCallbackChannel(buoyUrl);\n  request.setCallback(`${callback.service}/${callback.channel}`, true);\n  return callback;\n}\nfunction getUserAgent() {\n  const version = '1.4.0';\n  let agent = `@wharfkit/protocol-esr ${version}`;\n  if (typeof navigator !== 'undefined') {\n    agent += ' ' + navigator.userAgent;\n  }\n  return agent;\n}\nfunction prepareCallback(callbackChannel) {\n  const {\n    service,\n    channel\n  } = callbackChannel;\n  return {\n    url: `${service}/${channel}`,\n    background: true\n  };\n}\nfunction prepareCallbackChannel(buoyUrl) {\n  return {\n    service: buoyUrl,\n    channel: uuid()\n  };\n}\nfunction sealMessage(message, privateKey, publicKey, nonce) {\n  const secret = privateKey.sharedSecret(publicKey);\n  if (!nonce) {\n    nonce = UInt64.random();\n  }\n  const key = Checksum512.hash(Serializer.encode({\n    object: nonce\n  }).appending(secret.array));\n  const cbc = new AES_CBC(key.array.slice(0, 32), key.array.slice(32, 48));\n  const ciphertext = Bytes.from(cbc.encrypt(Bytes.from(message, 'utf8').array));\n  const checksumView = new DataView(Checksum256.hash(key.array).array.buffer);\n  const checksum = checksumView.getUint32(0, true);\n  return SealedMessage.from({\n    from: privateKey.toPublic(),\n    nonce,\n    ciphertext,\n    checksum\n  });\n}\nasync function verifyLoginCallbackResponse(callbackResponse, context) {\n  if (!callbackResponse.sig || callbackResponse.sig.length === 0) {\n    throw new Error('Invalid response, must have at least one signature');\n  }\n  let chain;\n  if (!context.chain && context.chains.length > 1) {\n    if (!callbackResponse.cid) {\n      throw new Error('Multi chain response payload must specify resolved chain id (cid)');\n    }\n  } else {\n    chain = context.chain || context.chains[0];\n    if (callbackResponse.cid && String(chain.id) !== callbackResponse.cid) {\n      throw new Error('Got response for wrong chain id');\n    }\n  }\n}\nfunction extractSignaturesFromCallback(payload) {\n  const signatures = [];\n  let index = 0;\n  let sig = payload.sig;\n  while (sig) {\n    signatures.push(String(sig));\n    sig = payload[`sig${index}`];\n    index++;\n  }\n  // Deduplicate and make signatures\n  return [...new Set(signatures)].map(s => Signature.from(s));\n}\nfunction isCallback(object) {\n  return 'tx' in object;\n}\nexport { BuoyInfo, BuoyMessage, BuoySession, LinkCreate, LinkInfo, SealedMessage, createIdentityRequest, extractSignaturesFromCallback, generateReturnUrl, getUserAgent, isAndroid, isAndroidWebView, isAppleHandheld, isBrave, isCallback, isChromeMobile, isChromeiOS, isEdge, isFirefox, isFirefoxiOS, isKnownMobile, isOpera, isReactNativeApp, logWarn, prepareCallback, sealMessage, setTransactionCallback, snakeToCamel, snakeToPascal, uuid, verifyLoginCallbackResponse, waitForCallback };\n", "/**\n * @wharfkit/wallet-plugin-anchor v1.5.0\n * https://github.com/wharfkit/wallet-plugin-anchor\n *\n * @license\n * Copyright (c) 2023 Greymass Inc. All Rights Reserved.\n * \n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n * \n * 1.  Redistribution of source code must retain the above copyright notice, this\n *     list of conditions and the following disclaimer.\n * \n * 2.  Redistribution in binary form must reproduce the above copyright notice,\n *     this list of conditions and the following disclaimer in the documentation\n *     and/or other materials provided with the distribution.\n * \n * 3.  Neither the name of the copyright holder nor the names of its contributors\n *     may be used to endorse or promote products derived from this software without\n *     specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n * IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,\n * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\n * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF\n * LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE\n * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED\n * OF THE POSSIBILITY OF SUCH DAMAGE.\n * \n * YOU ACKNOWLEDGE THAT THIS SOFTWARE IS NOT DESIGNED, LICENSED OR INTENDED FOR USE\n * IN THE DESIGN, CONSTRUCTION, OPERATION OR MAINTENANCE OF ANY MILITARY FACILITY.\n */\nimport { send } from '@greymass/buoy';\nimport { AbstractWalletPlugin, WalletPluginMetadata, Logo, PublicKey, ResolvedSigningRequest, Checksum256, PermissionLevel, PrivateKey, Serializer } from '@wharfkit/session';\nimport { createIdentityRequest, isKnownMobile, waitForCallback, verifyLoginCallbackResponse, LinkInfo, setTransactionCallback, generateReturnUrl, isAppleHandheld, sealMessage, isCallback, extractSignaturesFromCallback } from '@wharfkit/protocol-esr';\nvar login$1 = {\n  title: \"Connect with Anchor\",\n  body: \"Scan with Anchor on your mobile device or click the button below to open on this device.\",\n  link: \"Launch Anchor\"\n};\nvar transact$1 = {\n  title: \"Complete using Anchor\",\n  body: \"Please open your Anchor Wallet on \\\"{{channelName}}\\\" to review and approve this transaction.\",\n  label: \"Sign manually or with another device\",\n  link: \"Trigger Manually\",\n  \"await\": \"Waiting for response from Anchor\"\n};\nvar error$1 = {\n  expired: \"The request expired, please try again.\",\n  invalid_response: \"Invalid response from Anchor, must contain link_ch, link_key, link_name and cid flags.\",\n  not_completed: \"The request was not completed.\",\n  cancelled: \"The request was cancelled from Anchor.\"\n};\nvar en = {\n  login: login$1,\n  transact: transact$1,\n  error: error$1\n};\nvar ko = {};\nvar login = {\n  link: \"启动Anchor\",\n  body: \"在您的设备上使用Anchor扫描或者点击下方按钮打开。\",\n  title: \"连接Anchor\"\n};\nvar error = {\n  cancelled: \"请求已从Anchor取消。\",\n  not_completed: \"此请求未完成。\",\n  invalid_response: \"无效的Anchor响应，必须包含link_ch, link_key, link_name和cid标识符。\",\n  expired: \"请求已过期，请重试。\"\n};\nvar transact = {\n  \"await\": \"等待Anchor响应\",\n  link: \"手动触发\",\n  label: \"手动或使用其他设备签约\",\n  body: \"请在\\\"{{channelName}}\\\"上打开您的Anchor钱包以浏览并批准此交易。\",\n  title: \"完成使用Anchor\"\n};\nvar zh_hans = {\n  login: login,\n  error: error,\n  transact: transact\n};\nvar zh_hant = {};\nvar defaultTranslations = {\n  en,\n  ko,\n  'zh-Hans': zh_hans,\n  'zh-Hant': zh_hant\n};\nclass WalletPluginAnchor extends AbstractWalletPlugin {\n  constructor(options) {\n    super();\n    /**\n     * The unique identifier for the wallet plugin.\n     */\n    this.id = 'anchor';\n    /**\n     * The translations for this plugin\n     */\n    this.translations = defaultTranslations;\n    /**\n     * The logic configuration for the wallet plugin.\n     */\n    this.config = {\n      // Should the user interface display a chain selector?\n      requiresChainSelect: false,\n      // Should the user interface display a permission selector?\n      requiresPermissionSelect: false\n    };\n    /**\n     * The metadata for the wallet plugin to be displayed in the user interface.\n     */\n    this.metadata = WalletPluginMetadata.from({\n      name: 'Anchor',\n      description: '',\n      logo: Logo.from({\n        dark: 'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPHN2ZyB3aWR0aD0iMTYwIiBoZWlnaHQ9IjE2MCIgdmlld0JveD0iMCAwIDI1NiAyNTYiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgPGcgdHJhbnNmb3JtPSJtYXRyaXgoMS40NCwgMCwgMCwgMS40NCwgLTguNTAxOTI1LCAtNTcuMDc0NTcpIiBzdHlsZT0iIj4KICAgIDx0aXRsZT5XaGl0ZTwvdGl0bGU+CiAgICA8Y2lyY2xlIGN4PSI5NC43OTMiIGN5PSIxMjguNTI0IiByPSI4MCIgZmlsbD0iI0ZCRkRGRiIvPgogICAgPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0gOTQuNzk5IDc4LjUyNCBDIDk3LjA5OCA3OC41MjQgOTkuMTk1IDc5LjgzNyAxMDAuMTk4IDgxLjkwNiBMIDEyNC4yMDQgMTMxLjQwNiBMIDEyNC43NDYgMTMyLjUyNCBMIDExMS40MDkgMTMyLjUyNCBMIDEwNy41MyAxMjQuNTI0IEwgODIuMDY5IDEyNC41MjQgTCA3OC4xODkgMTMyLjUyNCBMIDY0Ljg1MyAxMzIuNTI0IEwgNjUuMzk1IDEzMS40MDYgTCA4OS40MDEgODEuOTA2IEMgOTAuNDA0IDc5LjgzNyA5Mi41MDEgNzguNTI0IDk0Ljc5OSA3OC41MjQgWiBNIDg2LjkxOSAxMTQuNTI0IEwgMTAyLjY4IDExNC41MjQgTCA5NC43OTkgOTguMjc0IEwgODYuOTE5IDExNC41MjQgWiBNIDExMi43OTMgMTQ5LjUyNCBMIDEyNC43OTggMTQ5LjUyNCBDIDEyNC40MzcgMTY1LjY3NiAxMTEuMDY3IDE3OC41MjQgOTQuNzk5IDE3OC41MjQgQyA3OC41MzIgMTc4LjUyNCA2NS4xNjIgMTY1LjY3NiA2NC44MDEgMTQ5LjUyNCBMIDc2LjgwNiAxNDkuNTI0IEMgNzcuMDg3IDE1Ni44NzggODEuOTc0IDE2My4xNTUgODguNzkzIDE2NS41MiBMIDg4Ljc5MyAxNDEuNTI0IEMgODguNzkzIDEzOC4yMSA5MS40OCAxMzUuNTI0IDk0Ljc5MyAxMzUuNTI0IEMgOTguMTA3IDEzNS41MjQgMTAwLjc5MyAxMzguMjEgMTAwLjc5MyAxNDEuNTI0IEwgMTAwLjc5MyAxNjUuNTI0IEMgMTA3LjYyIDE2My4xNjIgMTEyLjUxMSAxNTYuODgzIDExMi43OTMgMTQ5LjUyNCBaIiBmaWxsPSIjMzY1MEEyIi8+CiAgPC9nPgo8L3N2Zz4=',\n        light: 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYwIiBoZWlnaHQ9IjE2MCIgdmlld0JveD0iMCAwIDE2MCAxNjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjgwIiBjeT0iODAiIHI9IjgwIiBmaWxsPSIjMzY1MEEyIi8+CjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNODAuMDA2MyAzMEM4Mi4zMDUxIDMwIDg0LjQwMTkgMzEuMzEzNCA4NS40MDUgMzMuMzgxOEwxMDkuNDExIDgyLjg4MjJMMTA5Ljk1MyA4NEg5Ni42MTYzTDkyLjczNjYgNzZINjcuMjc1OUw2My4zOTYxIDg0SDUwLjA1OTRMNTAuNjAxNyA4Mi44ODE4TDc0LjYwNzcgMzMuMzgxOEM3NS42MTA4IDMxLjMxMzQgNzcuNzA3NSAzMCA4MC4wMDYzIDMwWk03Mi4xMjU2IDY2SDg3Ljg4N0w4MC4wMDYzIDQ5Ljc1MDFMNzIuMTI1NiA2NlpNOTcuOTk5NSAxMDFIMTEwLjAwNUMxMDkuNjQ0IDExNy4xNTIgOTYuMjczOCAxMzAgODAuMDA2MyAxMzBDNjMuNzM4OCAxMzAgNTAuMzY4NiAxMTcuMTUyIDUwLjAwNzggMTAxSDYyLjAxMzFDNjIuMjk0MSAxMDguMzU0IDY3LjE4MDQgMTE0LjYzMSA3NC4wMDAzIDExNi45OTZWOTNDNzQuMDAwMyA4OS42ODYzIDc2LjY4NjYgODcgODAuMDAwMyA4N0M4My4zMTQgODcgODYuMDAwMyA4OS42ODYzIDg2LjAwMDMgOTNWMTE3QzkyLjgyNjUgMTE0LjYzOCA5Ny43MTgzIDEwOC4zNTkgOTcuOTk5NSAxMDFaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K'\n      }),\n      homepage: 'https://greymass.com/anchor',\n      download: 'https://greymass.com/anchor/download'\n    });\n    this.buoyUrl = options?.buoyUrl || 'https://cb.anchor.link';\n    this.buoyWs = options?.buoyWs;\n  }\n  /**\n   * Performs the wallet logic required to login and return the chain and permission level to use.\n   *\n   * @param options WalletPluginLoginOptions\n   * @returns Promise<WalletPluginLoginResponse>\n   */\n  login(context) {\n    return new Promise((resolve, reject) => {\n      this.handleLogin(context).then(response => {\n        resolve(response);\n      }).catch(error => {\n        reject(error);\n      });\n    });\n  }\n  async handleLogin(context) {\n    if (!context.ui) {\n      throw new Error('No UI available');\n    }\n    // Retrieve translation helper from the UI, passing the app ID\n    const t = context.ui.getTranslate(this.id);\n    // Create the identity request to be presented to the user\n    const {\n      callback,\n      request,\n      sameDeviceRequest,\n      requestKey,\n      privateKey\n    } = await createIdentityRequest(context, this.buoyUrl);\n    // Elements for the login prompt\n    const elements = [{\n      type: 'link',\n      label: t('login.link', {\n        default: 'Launch Anchor'\n      }),\n      data: {\n        href: sameDeviceRequest.encode(true, false, 'esr:'),\n        label: t('login.link', {\n          default: 'Launch Anchor'\n        }),\n        variant: 'primary'\n      }\n    }];\n    // If we know this is NOT a mobile device, show the QR code\n    if (!isKnownMobile()) {\n      elements.unshift({\n        type: 'qr',\n        data: request.encode(true, false, 'esr:')\n      });\n    }\n    // Automatically try to open the link\n    window.location.href = sameDeviceRequest.encode(true, false, 'esr:');\n    // Tell Wharf we need to prompt the user with a QR code and a button\n    const promptResponse = context.ui?.prompt({\n      title: t('login.title', {\n        default: 'Connect with Anchor'\n      }),\n      body: t('login.body', {\n        default: 'Scan with Anchor on your mobile device or click the button below to open on this device.'\n      }),\n      elements\n    });\n    promptResponse.catch(() => {\n      // eslint-disable-next-line no-console\n      console.info('Modal closed');\n    });\n    // Await a promise race to wait for either the wallet response or the cancel\n    const callbackResponse = await waitForCallback(callback, this.buoyWs, t);\n    verifyLoginCallbackResponse(callbackResponse, context);\n    if (!callbackResponse.cid || !callbackResponse.sa || !callbackResponse.sp) {\n      throw new Error('Invalid callback response');\n    }\n    if (callbackResponse.link_ch && callbackResponse.link_key && callbackResponse.link_name) {\n      this.data.requestKey = requestKey;\n      this.data.privateKey = privateKey;\n      this.data.signerKey = callbackResponse.link_key && PublicKey.from(callbackResponse.link_key);\n      this.data.channelUrl = callbackResponse.link_ch;\n      this.data.channelName = callbackResponse.link_name;\n      try {\n        if (callbackResponse.link_meta) {\n          const metadata = JSON.parse(callbackResponse.link_meta);\n          this.data.sameDevice = metadata.sameDevice;\n          this.data.launchUrl = metadata.launchUrl;\n          this.data.triggerUrl = metadata.triggerUrl;\n        }\n      } catch (e) {\n        // console.log('Error processing link_meta', e)\n      }\n    }\n    const resolvedResponse = await ResolvedSigningRequest.fromPayload(callbackResponse, context.esrOptions);\n    const identityProof = resolvedResponse.getIdentityProof(callbackResponse.sig);\n    return {\n      chain: Checksum256.from(callbackResponse.cid),\n      permissionLevel: PermissionLevel.from({\n        actor: callbackResponse.sa,\n        permission: callbackResponse.sp\n      }),\n      identityProof\n    };\n  }\n  /**\n   * Performs the wallet logic required to sign a transaction and return the signature.\n   *\n   * @param chain ChainDefinition\n   * @param resolved ResolvedSigningRequest\n   * @returns Promise<Signature>\n   */\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  sign(resolved, context) {\n    return this.handleSigningRequest(resolved, context);\n  }\n  async handleSigningRequest(resolved, context) {\n    if (!context.ui) {\n      throw new Error('No UI available');\n    }\n    // Retrieve translation helper from the UI, passing the app ID\n    const t = context.ui.getTranslate(this.id);\n    // Set expiration time frames for the request\n    const expiration = resolved.transaction.expiration.toDate();\n    const now = new Date();\n    const expiresIn = Math.floor(expiration.getTime() - now.getTime());\n    // Create a new signing request based on the existing resolved request\n    const modifiedRequest = await context.createRequest({\n      transaction: resolved.transaction\n    });\n    // Set the expiration on the request LinkInfo\n    modifiedRequest.setInfoKey('link', LinkInfo.from({\n      expiration\n    }));\n    // Add the callback to the request\n    const callback = setTransactionCallback(modifiedRequest, this.buoyUrl);\n    const request = modifiedRequest.encode(true, false);\n    // Mobile will return true or false, desktop will return undefined\n    const isSameDevice = this.data.sameDevice !== false;\n    // Same device request\n    const sameDeviceRequest = modifiedRequest.clone();\n    const returnUrl = generateReturnUrl();\n    sameDeviceRequest.setInfoKey('same_device', true);\n    if (returnUrl) {\n      sameDeviceRequest.setInfoKey('return_path', returnUrl);\n    }\n    if (this.data.sameDevice) {\n      if (this.data.launchUrl) {\n        window.location.href = this.data.launchUrl;\n      } else if (isAppleHandheld()) {\n        window.location.href = 'anchor://link';\n      }\n    }\n    const signManually = () => {\n      context.ui?.prompt({\n        title: t('transact.sign_manually.title', {\n          default: 'Sign manually'\n        }),\n        body: t('transact.sign_manually.body', {\n          default: 'Scan the QR-code with Anchor on another device or use the button to open it here.'\n        }),\n        elements: [{\n          type: 'qr',\n          data: String(request)\n        }, {\n          type: 'link',\n          label: t('transact.sign_manually.link.title', {\n            default: 'Open Anchor'\n          }),\n          data: {\n            href: String(sameDeviceRequest),\n            label: t('transact.sign_manually.link.title', {\n              default: 'Open Anchor'\n            })\n          }\n        }]\n      });\n    };\n    // Tell Wharf we need to prompt the user with a QR code and a button\n    const promptPromise = context.ui.prompt({\n      title: t('transact.title', {\n        default: 'Complete using Anchor'\n      }),\n      body: t('transact.body', {\n        channelName: this.data.channelName,\n        default: `Please open your Anchor Wallet on \"${this.data.channelName}\" to review and approve this transaction.`\n      }),\n      elements: [{\n        type: 'countdown',\n        data: {\n          label: t('transact.await', {\n            default: 'Waiting for response from Anchor'\n          }),\n          end: expiration.toISOString()\n        }\n      }, {\n        type: 'button',\n        label: t('transact.label', {\n          default: 'Sign manually or with another device'\n        }),\n        data: {\n          onClick: isSameDevice ? () => window.location.href = sameDeviceRequest.encode() : signManually,\n          label: t('transact.label', {\n            default: 'Sign manually or with another device'\n          })\n        }\n      }]\n    });\n    // Create a timer to test the external cancelation of the prompt, if defined\n    const timer = setTimeout(() => {\n      if (!context.ui) {\n        throw new Error('No UI available');\n      }\n      promptPromise.cancel(t('error.expired', {\n        default: 'The request expired, please try again.'\n      }));\n    }, expiresIn);\n    // Clear the timeout if the UI throws (which generally means it closed)\n    promptPromise.catch(() => clearTimeout(timer));\n    // Wait for the callback from the wallet\n    const callbackPromise = waitForCallback(callback, this.buoyWs, t);\n    // Assemble and send the payload to the wallet\n    if (this.data.channelUrl) {\n      const service = new URL(this.data.channelUrl).origin;\n      const channel = new URL(this.data.channelUrl).pathname.substring(1);\n      const sealedMessage = sealMessage((this.data.sameDevice ? sameDeviceRequest : modifiedRequest).encode(true, false, 'esr:'), PrivateKey.from(this.data.privateKey), PublicKey.from(this.data.signerKey));\n      send(Serializer.encode({\n        object: sealedMessage\n      }).array, {\n        service,\n        channel\n      });\n    } else {\n      // If no channel is defined, fallback to the same device request and trigger immediately\n      window.location.href = sameDeviceRequest.encode();\n    }\n    // Wait for either the callback or the prompt to resolve\n    const callbackResponse = await Promise.race([callbackPromise, promptPromise]).finally(() => {\n      // Clear the automatic timeout once the race resolves\n      clearTimeout(timer);\n    });\n    const wasSuccessful = isCallback(callbackResponse) && extractSignaturesFromCallback(callbackResponse).length > 0;\n    if (wasSuccessful) {\n      // If the callback was resolved, create a new request from the response\n      const resolvedRequest = await ResolvedSigningRequest.fromPayload(callbackResponse, context.esrOptions);\n      // Return the new request and the signatures from the wallet\n      return {\n        signatures: extractSignaturesFromCallback(callbackResponse),\n        resolved: resolvedRequest\n      };\n    }\n    const errorString = t('error.not_completed', {\n      default: 'The request was not completed.'\n    });\n    promptPromise.cancel(errorString);\n    // This shouldn't ever trigger, but just in case\n    throw new Error(errorString);\n  }\n}\nexport { WalletPluginAnchor };\n"],
  "mappings": "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",
  "names": ["EventEmitter", "ListenerEncoding", "EventEmitter", "error", "SendResult", "s", "i", "stdlib", "foreign", "buffer", "SealedMessage", "LinkCreate", "LinkInfo", "BuoyMessage", "BuoySession", "BuoyInfo", "uuid", "error"]
}
